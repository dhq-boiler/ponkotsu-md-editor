<%
  lang = locals[:options][:lang] || :en
%>
<!-- MarkdownヘルプPopover -->
<div id="markdownHelpPopover" popover class="ponkotsu-md-editor-popover-modal" style="display:none; position:fixed; z-index:1050; left:50%; top:10vh; transform:translateX(-50%); width:80vw; max-width:900px; background:#222; color:#fff; border-radius:8px; box-shadow:0 0 20px #000a;">
  <div class="ponkotsu-md-editor-popover-header" style="display:flex; align-items:center; justify-content:space-between; padding:1rem; border-bottom:1px solid #444;">
    <h5 class="ponkotsu-md-editor-popover-title ponkotsu-md-editor-high-contrast-text" style="margin:0;">
      [book] <!-- アイコン -->
      <% case lang
          when :en then "Markdown Writing Guide"
          when :ja then "Markdown書き方ガイド"
          else "N/A"
          end %>
    </h5>
    <button type="button" id="markdownHelpPopoverClose" class="ponkotsu-md-editor-btn-close" style="filter:invert(1); background:none; border:none; font-size:1.5rem;">&times;</button>
  </div>
  <div class="ponkotsu-md-editor-popover-body" style="padding:1.5rem; max-height:70vh; overflow-y:auto;">
    <!-- タブナビゲーション -->
    <ul class="ponkotsu-md-editor-nav ponkotsu-md-editor-nav-tabs ponkotsu-md-editor-nav-fill ponkotsu-md-editor-mb-4" id="markdownTabs" role="tablist">
      <li class="ponkotsu-md-editor-nav-item" role="presentation">
        <button class="ponkotsu-md-editor-nav-link active" id="basic-tab" data-bs-toggle="tab" data-bs-target="#basic" type="button" role="tab">
          [type] <!-- アイコン -->
          <% case lang
             when :en then "Basic Syntax"
             when :ja then "基本書式"
             else "N/A"
             end %>
        </button>
      </li>
      <li class="ponkotsu-md-editor-nav-item" role="presentation">
        <button class="ponkotsu-md-editor-nav-link" id="structure-tab" data-bs-toggle="tab" data-bs-target="#structure" type="button" role="tab">
          [list-nested] <!-- アイコン -->
          <% case lang
             when :en then "Structural Elements"
             when :ja then "構造要素"
             else "N/A"
             end %>
        </button>
      </li>
      <li class="ponkotsu-md-editor-nav-item" role="presentation">
        <button class="ponkotsu-md-editor-nav-link" id="advanced-tab" data-bs-toggle="tab" data-bs-target="#advanced" type="button" role="tab">
          [gear] <!-- アイコン -->
          <% case lang
             when :en then "Advanced Features"
             when :ja then "応用機能"
             else "N/A"
             end %>
        </button>
      </li>
    </ul>

    <!-- タブコンテンツ -->
    <div class="ponkotsu-md-editor-tab-content" id="markdownTabContent">

      <!-- 基本書式タブ -->
      <div class="ponkotsu-md-editor-tab-pane fade show active" id="basic" role="tabpanel">
        <div class="ponkotsu-md-editor-table-responsive">
          <table class="ponkotsu-md-editor-table ponkotsu-md-editor-table-dark ponkotsu-md-editor-table-striped">
            <thead>
            <tr>
              <th width="35%"><% case lang
                                 when :en then "Writing"
                                 when :ja then "書き方"
                                 else "N/A"
                                 end %></th>
              <th width="35%"><% case lang
                                 when :en then "Result"
                                 when :ja then "結果"
                                 else "N/A"
                                 end %></th>
              <th width="30%"><% case lang
                                 when :en then "Description"
                                 when :ja then "説明"
                                 else "N/A"
                                 end %></th>
            </tr>
            </thead>
            <tbody>
            <tr>
              <td><code><% case lang
                           when :en then "# Heading 1"
                           when :ja then "# 見出し1"
                           else "N/A"
                           end %></code></td>
              <td><h1 style="font-size: 1.4rem; margin: 0;"><% case lang
                                       when :en then "Heading 1"
                                       when :ja then "見出し1"
                                       else "N/A"
                                       end %></h1></td>
              <td><% case lang
                     when :en then "Largest heading"
                     when :ja then "最大の見出し"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code><% case lang
                           when :en then "## Heading 2"
                           when :ja then "## 見出し2"
                           else "N/A"
                           end %></code></td>
              <td><h2 style="font-size: 1.2rem; margin: 0;"><% case lang
                                                               when :en then "Heading 2"
                                                               when :ja then "見出し2"
                                                               else "N/A"
                                                               end %></h2></td>
              <td><% case lang
                     when :en then "Second largest heading"
                     when :ja then "大見出し"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code><% case lang
                           when :en then "### Heading 3"
                           when :ja then "### 見出し3"
                           else "N/A"
                           end %></code></td>
              <td><h3 style="font-size: 1.1rem; margin: 0;"><% case lang
                                       when :en then "Heading 3"
                                       when :ja then "見出し3"
                                       else "N/A"
                                       end %></h3></td>
              <td><% case lang
                     when :en then "Third largest heading"
                     when :ja then "中見出し"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code><% case lang
                           when :en then "**Bold**"
                           when :ja then "**太字**"
                           else "N/A"
                           end %></code></td>
              <td><strong><% case lang
                             when :en then "Bold"
                             when :ja then "太字"
                             else "N/A"
                             end %></strong></td>
              <td><% case lang
                     when :en then "Emphasizes important text"
                     when :ja then "重要な箇所の強調"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code><% case lang
                           when :en then "*Italic*"
                           when :ja then "*斜体*"
                           else "N/A"
                           end %></code></td>
              <td><em><% case lang
                         when :en then "Italic"
                         when :ja then "斜体"
                         else "N/A"
                         end %></em></td>
              <td><% case lang
                     when :en then "Light emphasis"
                     when :ja then "軽い強調"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code><% case lang
                           when :en then "~~Strikethrough~~"
                           when :ja then "~~打ち消し~~"
                           else "N/A"
                           end %></code></td>
              <td><s><% case lang
                        when :en then "Strikethrough"
                        when :ja then "打ち消し"
                        else "N/A"
                        end %></s></td>
              <td><% case lang
                     when :en then "Strikethrough"
                     when :ja then "削除された内容"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code><% case lang
                           when :en then "`Inline Code`"
                           when :ja then "`インラインコード`"
                           else "N/A"
                           end %></code></td>
              <td><code style="background: #6c757d; padding: 2px 6px; border-radius: 4px; color: white;"><% case lang
                                           when :en then "Inline Code"
                                           when :ja then "インラインコード"
                                           else "N/A"
                                           end %></code></td>
              <td><% case lang
                     when :en then "Inline Code"
                     when :ja then "文中のコード"
                     else "N/A"
                     end %></td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 構造要素タブ -->
      <div class="ponkotsu-md-editor-tab-pane fade" id="structure" role="tabpanel">
        <div class="ponkotsu-md-editor-table-responsive">
          <table class="ponkotsu-md-editor-table ponkotsu-md-editor-table-dark ponkotsu-md-editor-table-striped">
            <thead>
            <tr>
              <th width="35%"><% case lang
                                 when :en then "Writing"
                                 when :ja then "書き方"
                                 else "N/A"
                                 end %></th>
              <th width="35%"><% case lang
                                 when :en then "Result"
                                 when :ja then "結果"
                                 else "N/A"
                                 end %></th>
              <th width="30%"><% case lang
                                 when :en then "Description"
                                 when :ja then "説明"
                                 else "N/A"
                                 end %></th>
            </tr>
            </thead>
            <tbody>
            <tr>
              <td><code>- <% case lang
                               when :en then "List Item"
                               when :ja then "リスト項目"
                               else "N/A"
                               end %></code></td>
              <td>
                <ul style="margin: 0; padding-left: 1rem;">
                  <li><% case lang
                         when :en then "List Item"
                         when :ja then "リスト項目"
                         else "N/A"
                         end %></li>
                </ul>
              </td>
              <td><% case lang
                     when :en then "Unordered List"
                     when :ja then "箇条書きリスト"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code>1. <% case lang
                              when :en then "Ordered Item"
                              when :ja then "番号付き項目"
                              else "N/A"
                              end %></code></td>
              <td>
                <ol style="margin: 0; padding-left: 1rem;">
                  <li><% case lang
                         when :en then "Ordered Item"
                         when :ja then "番号付き項目"
                         else "N/A"
                         end %></code></li>
                </ol>
              </td>
              <td><% case lang
                     when :en then "Ordered List"
                     when :ja then "順序付きリスト"
                     else "N/A"
                     end %></code></td>
            </tr>
            <tr>
              <td><code>- [ ] <% case lang
                                 when :en then "Incomplete Task"
                                 when :ja then "未完了タスク"
                                 else "N/A"
                                 end %></code></td>
              <td>
                <div style="margin: 0;">
                  <input type="checkbox" disabled> <% case lang
                                                      when :en then "Incomplete Task"
                                                      when :ja then "未完了タスク"
                                                      else "N/A"
                                                      end %>
                </div>
              </td>
              <td><% case lang
                     when :en then "Checkbox"
                     when :ja then "チェックボックス"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code>- [x] <% case lang
                                 when :en then "Completed Task"
                                 when :ja then "完了済みタスク"
                                 else "N/A"
                                 end %></code></td>
              <td>
                <div style="margin: 0;">
                  <input type="checkbox" checked disabled> <span style="text-decoration: line-through; color: #6c757d;"><% case lang
                                                                                    when :en then "Completed Task"
                                                                                    when :ja then "完了済みタスク"
                                                                                    else "N/A"
                                                                                    end %></span>
                </div>
              </td>
              <td><% case lang
                     when :en then "Completed Task"
                     when :ja then "完了タスク"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code>&gt; <% case lang
                                when :en then "Quote"
                                when :ja then "引用文"
                                else "N/A"
                                end %></code></td>
              <td>
                <blockquote style="border-left: 4px solid #0dcaf0; padding-left: 1rem; margin: 0; color: #adb5bd;">
                  <% case lang
                     when :en then "Quote"
                     when :ja then "引用文"
                     else "N/A"
                     end %>
                </blockquote>
              </td>
              <td><% case lang
                     when :en then "Blockquote"
                     when :ja then "引用ブロック"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code>---</code></td>
              <td><hr style="border: 1px solid #6c757d; margin: 0.5rem 0;"></td>
              <td><% case lang
                     when :en then "Horizontal Rule"
                     when :ja then "水平線"
                     else "N/A"
                     end %></td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 応用機能タブ -->
      <div class="ponkotsu-md-editor-tab-pane fade" id="advanced" role="tabpanel">
        <div class="ponkotsu-md-editor-table-responsive">
          <table class="ponkotsu-md-editor-table ponkotsu-md-editor-table-dark ponkotsu-md-editor-table-striped">
            <thead>
            <tr>
              <th width="35%"><% case lang
                                 when :en then "Writing"
                                 when :ja then "書き方"
                                 else "N/A"
                                 end %></th>
              <th width="35%"><% case lang
                                 when :en then "Result"
                                 when :ja then "結果"
                                 else "N/A"
                                 end %></th>
              <th width="30%"><% case lang
                                 when :en then "Description"
                                 when :ja then "説明"
                                 else "N/A"
                                 end %></th>
            </tr>
            </thead>
            <tbody>
            <tr>
              <td><code>[<% case lang
                              when :en then "Link"
                              when :ja then "リンク"
                              else "N/A"
                              end %>](https://example.com)</code></td>
              <td><a href="#" style="color: var(--accent-pink); text-decoration: none;"><% case lang
                                                   when :en then "Link"
                                                   when :ja then "リンク"
                                                   else "N/A"
                                                   end %></a></td>
              <td><% case lang
                     when :en then "External Link"
                     when :ja then "外部リンク"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td><code><% case lang
                           when :en then "![Image](Image URL)"
                           when :ja then "![画像](画像URL)"
                           else "N/A"
                           end %></code></td>
              <td>
                <div style="background: #6c757d; padding: 1rem; border-radius: 4px; text-align: center; color: white; font-size: 0.9rem;">
                  [image] <!-- アイコン --> <% case lang
                                                   when :en then "Image"
                                                   when :ja then "画像"
                                                   else "N/A"
                                                   end %>
                </div>
              </td>
              <td><% case lang
                     when :en then "Image"
                     when :ja then "画像の挿入"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td style="font-size: 0.85rem;">
                <code>```<br><% case lang
                                when :en then "Code Block"
                                when :ja then "コードブロック"
                                else "N/A"
                                end %><br>function hello() {<br>&nbsp;&nbsp;return 'Hello';<br>}<br>```</code>
              </td>
              <td>
                <pre style="background: #2d3748; color: #e2e8f0; padding: 0.75rem; border-radius: 4px; margin: 0; font-size: 0.85rem;"><% case lang
                                        when :en then "Code Block"
                                        when :ja then "コードブロック"
                                        else "N/A"
                                        end %>
function hello() {
  return 'Hello';
}</pre>
              </td>
              <td><% case lang
                     when :en then "Multiple Line Code"
                     when :ja then "複数行コード"
                     else "N/A"
                     end %></td>
            </tr>
            <tr>
              <td style="font-size: 0.8rem;">
                <code><% case lang
                         when :en then "| Col 1 | Col 2 | Col 3 |<br>|-----|-----|-----|<br>| A | B | C |"
                         when :ja then "| 列1 | 列2 | 列3 |<br>|-----|-----|-----|<br>| A | B | C |"
                         else "N/A"
                         end %></code>
              </td>
              <td>
                <table class="ponkotsu-md-editor-table ponkotsu-md-editor-table-sm ponkotsu-md-editor-table-bordered" style="margin: 0; font-size: 0.85rem;">
                  <% case lang %>
                  <% when :en %>
                    <thead>
                    <tr style="background: #495057;">
                      <th>Row 1</th>
                      <th>Row 2</th>
                      <th>Row 3</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                      <td>A</td>
                      <td>B</td>
                      <td>C</td>
                    </tr>
                    </tbody>
                  <% when :ja %>
                    <thead>
                    <tr style="background: #495057;">
                      <th>列1</th>
                      <th>列2</th>
                      <th>列3</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                      <td>A</td>
                      <td>B</td>
                      <td>C</td>
                    </tr>
                    </tbody>
                  <% end %>
                </table>
              </td>
              <td><% case lang
                     when :en then "Table"
                     when :ja then "テーブル（表）"
                     else "N/A"
                     end %></td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- フッター：ツールバー案内 -->
    <div class="ponkotsu-md-editor-alert ponkotsu-md-editor-alert-info ponkotsu-md-editor-mt-4" role="alert">
      [lightbulb] <!-- アイコン -->
      <strong><% case lang
                 when :en then "Useful Features:"
                 when :ja then "便利機能："
                 else "N/A"
                 end %></strong>
      <% case lang %>
      <% when :en %>
        Clicking the toolbar buttons above allows you to easily insert these Markdown syntaxes.
        The code button [code] <!-- アイコン --> automatically determines whether to insert inline code or a code block based on the selected text.
      <% when :ja %>
        上部のツールバーボタンをクリックすると、これらのMarkdown記法を簡単に挿入できます。
        コードボタン [code] <!-- アイコン --> は選択範囲に応じてインラインコードまたはコードブロックを自動判定します。
      <% end %>
    </div>
  </div>
</div>
